# MAPEAMENTO DE PINOS I/O - PROJETO KLIPPER
# Arquivo de documentação dos pinos utilizados
# Separado por HOST (MCU) e NATIVO (direto)

#=====================================================
# PINOS MCU (CONTROLADORA PRINCIPAL - STM32F407)
#=====================================================

[mcu]
# Configuração da MCU principal (STM32F407)
serial: /dev/serial/by-id/usb-Klipper_stm32f407xx_*
restart_method: command

# MOTORES DE PASSO (MCU - STM32F407)
# X Axis
step_pin: PE9 (MCU)
dir_pin: PF1 (MCU)
enable_pin: !PF2 (MCU)

# Y Axis  
step_pin: PE11 (MCU)
dir_pin: PE8 (MCU)
enable_pin: !PD7 (MCU)

# Z Axis (Dual Z)
step_pin: PE13 (MCU)
dir_pin: PC2 (MCU)
enable_pin: !PC0 (MCU)

# Z1 Axis (Segundo motor Z)
step_pin: PE14 (MCU)
dir_pin: PA0 (MCU)
enable_pin: !PC3 (MCU)

# Extruder T0
step_pin: PD15 (MCU)
dir_pin: PE7 (MCU)
enable_pin: !PA3 (MCU)

# Extruder T1
step_pin: PD13 (MCU)
dir_pin: PG9 (MCU)
enable_pin: !PF0 (MCU)

# SENSORES DE TEMPERATURA (MCU - STM32F407)
# Hotend T0
sensor_pin: PF4 (MCU)

# Hotend T1
sensor_pin: PF5 (MCU)

# Heated Bed
sensor_pin: PF3 (MCU)

# AQUECEDORES (MCU - STM32F407)
# Hotend T0
heater_pin: PB1 (MCU)

# Hotend T1
heater_pin: PD14 (MCU)

# Heated Bed
heater_pin: PD12 (MCU)

# VENTILADORES (MCU - STM32F407)
# Part Cooling T0
pin: PB0 (MCU)

# Part Cooling T1
pin: PC8 (MCU)

# Hotend Fan T0
pin: PB2 (MCU)

# Hotend Fan T1
pin: PE5 (MCU)

# Controller Fan
pin: PA8 (MCU)

# ENDSTOPS (MCU - STM32F407)
# X Endstop
pin: PG6 (MCU)

# Y Endstop
pin: PG9 (MCU)

# Z Endstop
pin: PG10 (MCU)

# PROBE/SENSOR (MCU - STM32F407)
# BLTouch/Probe
pin: PG5 (MCU)
control_pin: PA1 (MCU)

# LIDAR Sensor
rx_pin: PD9 (MCU)
tx_pin: PD8 (MCU)

# LEDS (MCU - STM32F407)
# Neopixel/WS2812
pin: PB6 (MCU)

# Status LED
pin: PA13 (MCU)

# FILAMENT SENSORS (MCU - STM32F407)
# T0 Filament Sensor
pin: PE6 (MCU)

# T1 Filament Sensor
pin: PE4 (MCU)

# SPI/I2C (MCU - STM32F407)
# SPI1
sclk_pin: PA5 (MCU)
mosi_pin: PA7 (MCU)
miso_pin: PA6 (MCU)
cs_pin: PA4 (MCU)

# I2C1
scl_pin: PB8 (MCU)
sda_pin: PB9 (MCU)

#=====================================================
# PINOS HOST (RASPBERRY PI - CONTROLE DIRETO)
#=====================================================

# BOTÕES E SWITCHES (GPIO Raspberry Pi)
# Emergency Stop
# Pino: GPIO21 (HOST - Raspberry Pi)
# Função: Parada de emergência

# Power Switch
# Pino: GPIO20 (HOST - Raspberry Pi)
# Função: Liga/Desliga sistema

# Tool Change Button
# Pino: GPIO16 (HOST - Raspberry Pi)
# Função: Troca manual de ferramenta

# RELÉS E CONTROLE DE ENERGIA (GPIO Raspberry Pi)
# Main Power Relay
# Pino: GPIO18 (HOST - Raspberry Pi)
# Função: Controle de energia principal

# Heated Bed Relay
# Pino: GPIO23 (HOST - Raspberry Pi)
# Função: Relé auxiliar da mesa aquecida

# SENSORES AUXILIARES (GPIO Raspberry Pi)
# Chamber Temperature
# Pino: GPIO4 (HOST - Raspberry Pi)
# Função: Sensor de temperatura da câmara

# Vibration Sensor
# Pino: GPIO17 (HOST - Raspberry Pi)
# Função: Detecção de vibração/ressonância

# COMUNICAÇÃO EXTERNA (GPIO Raspberry Pi)
# UART Debug
# TX: GPIO14 (HOST - Raspberry Pi)
# RX: GPIO15 (HOST - Raspberry Pi)
# Função: Debug e comunicação serial

# CAN Bus (se aplicável)
# CAN_H: Pino específico do transceiver (HOST)
# CAN_L: Pino específico do transceiver (HOST)
# Função: Comunicação CAN para expansões

#=====================================================
# MAPEAMENTO POR FUNÇÃO
#=====================================================

# SISTEMA DE MOVIMENTO (MCU)
# X: PE9, PF1, PF2, PG6 (MCU)
# Y: PE11, PE8, PD7, PG9 (MCU)
# Z: PE13, PC2, PC0, PG10 (MCU)
# Z1: PE14, PA0, PC3 (MCU)

# SISTEMA DE EXTRUSÃO (MCU)
# T0: PD15, PE7, PA3, PF4, PB1 (MCU)
# T1: PD13, PG9, PF0, PF5, PD14 (MCU)

# SISTEMA DE REFRIGERAÇÃO (MCU)
# Part Cooling: PB0, PC8 (MCU)
# Hotend Fans: PB2, PE5 (MCU)
# Controller: PA8 (MCU)

# SISTEMA DE SENSORIAMENTO (MCU)
# Probe: PG5, PA1 (MCU)
# LIDAR: PD9, PD8 (MCU)
# Filament: PE6, PE4 (MCU)
# Temperature: PF3, PF4, PF5 (MCU)

# SISTEMA DE ILUMINAÇÃO (MCU)
# Neopixel: PB6 (MCU)
# Status: PA13 (MCU)

# SISTEMA DE COMUNICAÇÃO (MCU)
# SPI: PA5, PA7, PA6, PA4 (MCU)
# I2C: PB8, PB9 (MCU)
# UART: PD9, PD8 (MCU)

# SISTEMA DE CONTROLE (HOST)
# Botões: GPIO16, GPIO20, GPIO21 (HOST)
# Relés: GPIO18, GPIO23 (HOST)
# Sensores Aux: GPIO4, GPIO17 (HOST)
# Debug UART: GPIO14, GPIO15 (HOST)

#=====================================================
# PINOS RESERVADOS/LIVRES
#=====================================================

# Pinos disponíveis para expansão futura:
# MCU (STM32F407): PC1, PC4, PC5, PC6, PC7, PC9, PC10, PC11, PC12, PC13, PC14, PC15
# HOST (Raspberry Pi): GPIO2, GPIO3, GPIO5, GPIO6, GPIO12, GPIO13, GPIO19, GPIO22, GPIO24, GPIO25, GPIO26, GPIO27

#=====================================================
# NOTAS IMPORTANTES
#=====================================================

# 1. Todos os pinos de enable dos motores são invertidos (!) - MCU
# 2. Sensores de temperatura usam ADC (PF3, PF4, PF5) - MCU
# 3. LIDAR usa UART3 (PD8/PD9) - MCU
# 4. Probe usa servo control (PA1) + sensor (PG5) - MCU
# 5. Neopixel requer pino com suporte a PWM - MCU
# 6. Filament sensors são pull-up internos - MCU
# 7. Endstops são normalmente abertos (NO) - MCU
# 8. Ventiladores são PWM controlados - MCU
# 9. Aquecedores são MOSFET controlados - MCU
# 10. SPI é usado para displays/SD cards - MCU
# 11. GPIO do Raspberry Pi controlam relés e botões - HOST
# 12. Comunicação entre HOST e MCU via USB serial

# VERSÃO: 1.0
# DATA: $(date)
# AUTOR: Sistema Klipper Multi-Tool
# COMPATIBILIDADE: STM32F407 + Raspberry Pi